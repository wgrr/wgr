#!/usr/bin/env rc

. 9.rc

if(! pgrep fontsrv >/dev/null >[2=1]){
	echo starting fontsrv
	fontsrv > /tmp/fontsrv.log >[2=1] &
}

if(! pgrep plumber >/dev/null >[2=1]){
	echo starting plumber
	plumber > /tmp/plumber.log >[2=1] &
}

PAGER=$PLAN9/bin/nobs
MANPAGER=$PLAN9/bin/nobs
NPROC=`{nproc}

TERM='dumb'

acmeshell=$PLAN9/bin/rc
shell=$PLAN9/bin/rc
SHELL=$PLAN9/bin/rc
prompt='% '

user=$USER
home=$HOME
ns=`{namespace}
font=/tmp/f/Go-Bold/9a/font

if(! pgrep -f '^9pfuse.*'$ns'\/font' >/dev/null >[2=1]){
	echo mounting fonts
	mkdir -p /tmp/f
	9pfuse $ns/font /tmp/f
}

fn cd { builtin cd $1 && awd $sysname }
exec acme -a -f $font $*

